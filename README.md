# 知乎社区的Go语言简单实现
### 1.本项目以 Go + Gin 实现一个模拟知乎风格的 API 服务，包含用户、帖子、评论、点赞、关注等基础逻辑。项目使用 GORM（MySQL）做持久化，Redis 做缓存/限流

### 特性
    Gin 框架实现 HTTP API
    GORM 实现 
    Redis 支持（限流、缓存）
    Swagger 文档（swaggo）
    可构建为单一静态二进制并打包为轻量镜像

### 前提
    Go 1.21+
    Docker（可选）
    MySQL 5.7+/8.0+
    Redis 5+

### 快速开始（本地）
    1. 克隆仓库
    git clone https://github.com/lilnuo/ZHI-HU.git
    2. 准备配置文件 `config/config.yaml`
    3. 安装依赖并运行
    go mod tidy
    go run .

    4. 访问 API
    默认监听 8080（详见配置），开发环境可访问 Swagger： http://localhost:8080/swagger/index.html
### 1.基本的用户系统
    1.注册与登陆
    2.用户基本信息
    3.密码从环境中获取
    4.用户信息的修改
### 2.文章与问题
    1.获取/删除/更新/发布
    2.恢复/评论
    3.对问题关注/评论点赞/帖子点赞
    4.热度排行榜
## 实现
    1.使用transaction保证要么全部成功，要么全部失败
    2.gorm.Expr(原子操作，避免并发竞争)
    
### 3.关注用户并接收其动态
    1.关注与取消
    2.关注列表与关注者列表
    3.获取指定用户主页(从关注列表进去可以过去个人信息)
## 写时更新
    1.用户查看关注动态直接从缓存读取，性能高
    2.使用Redis的zset存储动态时间线
    3.使用Goroutine异步执行推送逻辑，不阻塞主流程
### 4.内容的搜索
    1.全文索引（两个字段建立联合索引）
    用gorm快捷索引
### 5.文章状态
    1.草稿箱
    2.发布与删除
### 6.管理员禁言
### 7.限流机制（redis不太会）
### 8.配置管理（viper加载配置）
### 9.消息通知和后台私信
    1.红点点
## 缓存策略
    1.使用返回一个错误，防止缓存穿透
    2.使用singleflight锁第一个请求，避免大量请求同时查询数据库，防止缓存击穿
    3.随机过期时间防止缓存雪崩
## 优点 
    添加context和gorm.DB
    feed流推拉结合 
    Redis的zset存储动态时间线
    Goroutine异步执行异步推送消息
    统一错误处理
### 缺点
    1.没有测试文档（没搞懂），不会接口本地测试
    2.事务来自ai，没有进行学习
    3.整体逻辑不够清晰
    4.如果有啥建议或者意见，可以直接回我邮件，或者私信我，我感觉自己学的不是很好（may时间用的太少）